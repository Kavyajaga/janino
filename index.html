<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Janino by janino-compiler</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <script src="javascripts/scale.fix.js"></script>

    <script src="syntaxhighlighter_3.0.83/scripts/shCore.js"></script>
    <script src="syntaxhighlighter_3.0.83/scripts/shBrushBash.js"></script>
    <script src="syntaxhighlighter_3.0.83/scripts/shBrushJava.js"></script>
    <script src="syntaxhighlighter_3.0.83/scripts/shBrushXml.js"></script>
    <link href="syntaxhighlighter_3.0.83/styles/shCore.css" rel="stylesheet" type="text/css">
    <link href="syntaxhighlighter_3.0.83/styles/shThemeRDark.css" rel="stylesheet" type="text/css">

    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <style>
.syntaxHighlighter.xml {
  padding: 6px 12px 6px 12px;
  line-height: 1em;
}
.syntaxHighlighter.xml .plain {
  color: #b9bdb6;
}
.syntaxHighlighter.xml .spaces {
}
.syntaxHighlighter.xml .keyword {
  color: #5ba1cf;
}
    </style>
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Janino</h1>
        <p>A super-small, super-fast Java compiler</p>
        <p class="view"><a href="https://github.com/janino-compiler/janino">
          View the Project on GitHub <small>janino-compiler/janino</small></a>
        </p>
        <ul>
          <li><a href="#download">Download <strong>ZIP File</strong></a></li>
          <li><a href="apidocs/">Browse <strong>JAVADOC</strong></a></li>
          <li><a href="https://github.com/janino-compiler/janino">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <div style="border:solid 1px; padding:12px;margin-bottom:12px;font-weight:bold">
          <div style="font-size:24px">Breaking news!</div>
          <div style="margin-bottom:8px">
            Janino is now "Tee-ware", which means that the applicable license is still BSD,
            but you are free to
            <a href="https://teespring.com/janino" target="blank">buy a fan t-shirt on Teespring</a>
            (one per CPU, or as many as you want ðŸ˜‰).
          </div>
          <div>
            Support the software development and show your appreciation by purchasing Janino merch!
          </div>
        </div>
        <div style="float:right;clear:right;position:relative;margin:0.5em 0 0.8em 1.4em">
          <img src="logo/logo_167x134.gif" alt="Janino Swoosh" />
        </div>
        <p>
          Janino is a super-small, super-fast Java compiler.
        </p>
        <p>
          Janino can not only <a href="#janino-as-a-command-line-java-compiler">compile a set of source files to a set
          of class files</a> like JAVAC, but also compile
          <a href="#janino-as-an-expression-evaluator">a Java expression</a>,
          <a href="#janino-as-a-script-evaluator">a block</a>,
          <a href="#janino-as-a-class-body-evaluator">a class body</a>,
          <a href="#janino-as-a-simple-compiler">one .java file</a> or
          <a href="#janino-as-a compiler">a set of .java files</a>
          in memory, load the bytecode and execute it directly in the running JVM.
        </p>

        <p>JANINO is integrated with Apache Commons JCI ("Java Compiler Interface") and JBoss Rules / Drools.</p>

        <p>
          JANINO can also be used for
          <a href="#janino-as-a-code-analyser">static code analysis</a>
          or
          <a href="#janino-as-a-code-manipulator">code manipulation</a>.
        </p>

        <h2>Table of Contents</h2>
        <ul>
          <li><a href="#getting_started">Getting Started</a></li>
          <li><a href="#properties">Properties</a></li>
          <li><a href="#requirements">Requirements</a></li>
          <li><a href="#limitations">Limitations</a></li>
          <li><a href="#license">License</a></li>
          <li>
            <a href="#download">Download</a>
            <ul>
              <li><a href="#packages"          >Packages</a></li>
              <li><a href="#security_integrity">Security / integrity</a></li>
              <li><a href="#installation"      >Installation</a></li>
              <li><a href="#examples"          >Examples</a></li>
            </ul>
          </li>
          <li>
            <a href="#documentation">Documentation</a>
            <ul>
              <li><a href="#change_log">Change Log</a></li>
              <li><a href="#javadoc"   >JAVADOC</a></li>
              <li><a href="#books"     >Books</a></li>
              <li><a href="#links"     >Links</a></li>
              <li>
                <a href="#basic-examples">Basic Examples</a>
                <ul>
                  <li><a href="#janino-as-an-expression-evaluator">Janino as an Expression Evaluator</a></li>
                  <li><a href="#janino-as-a-script-evaluator"     >Janino as a Script Evaluator</a></li>
                  <li><a href="#janino-as-a-class-body-evaluator" >Janino as a Class Body Evaluator</a></li>
                  <li><a href="#janino-as-a-simple-compiler"      >Janino as a Simple Compiler</a></li>
                  <li><a href="#janino-as-a compiler"             >Janino as a Compiler</a></li>
                </ul>
              </li>
              <li>
                <a href="#advanced-examples">Advanced Examples</a>
                <ul>
                  <li><a href="#janino-as-a-source-code-classloader"   >Janino as a Source Code Class Loader</a></li>
                  <li><a href="#jsh"                                   >jsh - the Java shell</a></li>
                  <li><a href="#janino-as-a-command-line-java-compiler">Janino as a Command-Line Java Compiler</a></li>
                  <li><a href="#janino-as-an-ant-compiler"             >Janino as an ANT Compiler</a></li>
                  <li><a href="#janino-as-a-tomcat-compiler"           >Janino as a TOMCAT Compiler</a></li>
                  <li><a href="#janino-as-a-code-analyser"             >Janino as a Code Analyser</a></li>
                  <li><a href="#janino-as-a-code-manipulator"          >Janino as a Code Manipulator</a></li>
                  <li><a href="#alternative-compiler-implementations"  >Alternative Compiler Implementations</a></li>
                </ul>
              </li>
              <li><a href="#security" >Security</a></li>
              <li><a href="#debugging">Debugging</a></li>
            </ul>
          </li>
          <li>
            <a href="#contact">Contact</a>
            <ul>
              <li><a href="#reporting-bugs"         >Reporting bugs</a></li>
              <li><a href="#requesting-support"     >Requesting support</a></li>
              <li><a href="#requesting-new-features">Requesting new features</a></li>
              <li><a href="#feedback"               >Feedback</a></li>
            </ul>
          </li>
          <li>
            <a href="#developers">Developers</a>
            <ul>
              <li><a href="#source-code-repository">Source Code Repository</a></li>
              <li><a href="#contributing"          >Contributing</a></li>
            </ul>
          </li>
        </ul>

        <h2>
          <a id="getting_started" class="anchor" href="#getting_started" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Getting Started
        </h2>

        <p>
          What's this all about? Check out <a href="2014-02-18_SWM-JAK.pdf">this PDF presentation</a> for a quick
          start. (Notice that some of the information is outdated, e.g. the references to CODEHAUS, which has passed
          away some time 2015.)
        </p>

        <h2>
          <a id="properties" class="anchor" href="#properties" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Properties
        </h2>

        <p>
          The major design goal was to keep the compiler small and simple, while providing an (almost) complete Java
          compiler.
        </p>

        <p>
          The following elements of the Java programming language are implemented (or, where noted, partially
          implemented):
        </p>

        <ul>
          <li>
            Java 1.4 language features:
            <ul>
              <li><code>package</code> declaration, <code>import</code> declaration</li>
              <li><code>class</code> declaration</li>
              <li><code>interface</code> declaration</li>
              <li>Inheritance (<code>extends</code> and <code>implements</code>)</li>
              <li>Static member type declaration</li>
              <li>Inner (non-static member, local, anonymous) class declaration</li>
              <li>Class initializer, instance initializer</li>
              <li>Field declaration, method declaration</li>
              <li>Local variable declaration</li>
              <li>Class variable initializer, instance variable initializer</li>
              <li>Block statement (<code>{...}</code>)</li>
              <li><code>if ... else</code> statement</li>
              <li>Basic <code>for</code> statement</li>
              <li><code>while</code> statement</li>
              <li><code>do ... while</code> statement</li>
              <li><code>try ... catch ... finall</code>y statement</li>
              <li><code>throw</code> statement</li>
              <li><code>return</code> statement</li>
              <li><code>break</code> statement</li>
              <li><code>continue</code> statement</li>
              <li><code>switch</code> statement</li>
              <li><code>synchronized</code> statement</li>
              <li>
                All primitive types (<code>boolean</code>, <code>char</code>, <code>byte</code>, <code>short</code>,
                <code>int</code>, <code>long</code>, <code>float</code>, <code>double</code>)
              </li>
              <li>Assignment operator <code>=</code></li>
              <li>
                Compound assignment operators <code>+=</code>, <code>-=</code>, <code>*=</code>, <code>/=</code>,
                <code>&amp;=</code>, <code>|=</code>, <code>^=</code>, <code>%=</code>, <code>&lt;&lt;=</code>,
                <code>&gt;&gt;=</code>, <code>&gt;&gt;&gt;=</code>
              </li>
              <li>Conditional operators <code>? ... :</code>, <code>&amp;&amp;</code>, <code>||</code></li>
              <li>Boolean logical operators <code>&amp;</code>, <code>^</code>, <code>|</code></li>
              <li>Integer bitwise operators <code>&amp;</code>, <code>^</code>, <code>|</code></li>
              <li>
                Numeric operators <code>*</code>, <code>/</code>, <code>%</code>, <code>+</code>, <code>-</code>,
                <code>&lt;&lt;</code>, <code>&gt;&gt;</code>, <code>&gt;&gt;&gt;</code>
              </li>
              <li>String concatenation operator <code>+</code></li>
              <li>Operators <code>++</code> and <code>--</code></li>
              <li>Type comparison operator <code>instanceof</code></li>
              <li>Unary operators <code>+</code>, <code>-</code>, <code>~</code>, <code>!</code></li>
              <li>Parenthesized expression</li>
              <li>Field access (like <code>System.out</code>)</li>
              <li>Superclass member access (<code>super.meth()</code>, <code>super.field</code>)</li>
              <li><code>this</code> (reference to current instance)</li>
              <li>Alternate constructor invocation (<code>this(a, b, c);</code>)</li>
              <li>Superclass constructor invocation (<code>super(a, b, c);</code>)</li>
              <li>Method invocation (<code>System.out.println("Hello")</code>)</li>
              <li>Class instance creation (<code>new Foo()</code>)</li>
              <li>Primitive array creation (<code>new int[10][5][]</code>)</li>
              <li>Class or interface array creation (<code>new Foo[10][5][]</code>)</li>
              <li>Array access (<code>args[0]</code>)</li>
              <li>Local variable access</li>
              <li>Integer literal (decimal, hex and octal)</li>
              <li>Floating-point literal (decimal)</li>
              <li>Boolean, character, string literal</li>
              <li><code>null</code> literal</li>
              <li>Numeric conversions: Unary, binary, widening, narrowing</li>
              <li>Reference conversions: Widening, Narrowing</li>
              <li>Assignment conversion</li>
              <li>String conversion (for string concatenation)</li>
              <li>Cast</li>
              <li>Constant expression</li>
              <li>Block scope, method scope, class scope, global scope</li>
              <li><code>throws</code> clause</li>
              <li>Array initializer (<code>String[] a = { "x", "y", "z" }</code>)</li>
              <li>Primitive class literals (<code>int.class</code>)</li>
              <li>Non-primitive class literals (<code>String.class</code>)</li>
              <li>References between uncompiled compilation units</li>
              <li>Line number tables ("<code>-g:lines</code>")</li>
              <li>Source file information ("<code>-g:source</code>")</li>
              <li>Local variable information information ("<code>-g:vars</code>")</li>
              <li>
                Handling of <code><a href="https://github.com/deprecated" class="user-mention">@deprecated</a></code>
                doc comment tag
              </li>
              <li>
                Accessibility checking (<code>public</code>, <code>protected</code>, <code>private</code>, default)
              </li>
              <li>Checking of "definite assignment"</li>
              <li>Methods that compile to more than 32 KB</li>
              <li>
                <code>assert</code> (partially implemented - assertions are always enabled, as if the JVM was started
                with the "<code>-ea</code>" command line option)
              </li>
              <li><code>StringBuilder</code> class used for string concatenation</li>
            </ul>
          </li>

          <li>
            Java 5 language features:
            <ul>
              <li>Declaration of parameterized types</li>
              <li>
                Type arguments (e.g. <code>List&lt;String&gt;</code>):
                Are parsed, but otherwise ignored. The most significant restriction that follows is
                that you must cast return values from method invocations, e.g. "<code>(String) myMap.get(key)</code>"
              </li>
              <li>Enhanced <code>for</code> statement</li>
              <li>Autoboxing and unboxing</li>
              <li><code>enum</code> declaration</li>
              <li><code>enum</code> <code>switch</code> statement</li>
              <li>Annotation type declaration (including method default values)</li>
              <li>Variable arity methods (a.k.a. "varargs")</li>
              <li>Static imports (single and on-demand; fields, types and methods)</li>
              <li>Annotations</li>
              <li>Covariant return types</li>
              <li><code>@Override</code> annotation</li>
              <li>Hexadecimal floating point literals</li>
            </ul>
          </li>

          <li>
            Java 7 language features:
            <ul>
              <li>Binary integer literal (JLS7 3.10.1)</li>
              <li>Underscores in numeric literals (JLS7 3.10.1)</li>
              <li>String <code>switch</code> statement (JLS7 14.11)</li>
              <li><code>try</code>-with-resources statement (JLS7 14.20.3)</li>
              <li>
                <code>catch</code>ing and rethrowing multiple exception types: Partially implemented; parsed and
                unparsed, but not compilable
              </li>
              <li>Type interference for generic instance creation (a.k.a. the "diamond operator") (JLS11 15.9.1)</li>
            </ul>
          </li>

          <li>
            Java 8 language features:
            <ul>
              <li>Lambda expressions: Partially implemented; parsed and unparsed, but not compilable</li>
              <li>Method references: Partially implemented; parsed and unparsed, but not compilable</li>
              <li>Default methods</li>
              <li>Static interface methods</li>
            </ul>
          </li>

          <li>
            Java 9 language features:
            <ul>
              <li>Private interface method</li>
              <li>
                Enhanced <code>try</code>-with-resources statement, allowing <code>VariableAccess</code>es as
                resources (JLS9 14.20.3)
              </li>
              <li>
                Modules: Partially implemented; modular compilation units are parsed and unparsed, but not compilable
              </li>
            </ul>
          </li>

          <li>
            Java 10 language features:
            <ul>
              <li>Local variable type inference: Partially implemented; parsed and unparsed, but not compilable</li>
            </ul>
          </li>

          <li>
            Java 11 language features:
            <ul>
              <li>Lambda parameter type inference: Partially implemented; parsed and unparsed, but not compilable</li>
            </ul>
          </li>

          <li>
            Java 15 language features:
            <ul>
              <li>Text blocks</li>
            </ul>
          </li>
        </ul>

        <p>
          JANINO supports all these language features, even if it runs in an older JRE!
        </p>

        <h2>
          <a id="requirements" class="anchor" href="#requirements" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Requirements
        </h2>

        <p>
          JANINO only requires a Java 7 (or later) JRE or later, not a JDK. It has no dependencies whatsoever on any
          third-party libraries.
        </p>

        <p>
          JANINO is routinely tested against the following JREs:
        </p>
        <table border="1">
          <tr><th>Java version</th><th>JRE version</th>                     <th>Release Date</th><th>Status</th></tr>
          <tr><td>7</td>           <td>jdk1.7.0_21 (32 bit)</td>            <td>2011-07-28</td>  <td>passed</td></tr>
          <tr><td>8</td>           <td>adopt_openjdk-8.0.292.10-hotspot</td><td>?</td>           <td>passed</td></tr>
          <tr><td>11</td>          <td>adopt_openjdk-11.0.11.9-hotspot</td> <td>?</td>           <td>passed</td></tr>
          <tr><td>17</td>          <td>adopt_openjdk-17.0.1+12</td>         <td>?</td>           <td>passed</td></tr>
        </table>

        <h2>
          <a id="limitations" class="anchor" href="#limitations" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Limitations
        </h2>

        <p>
          The following elements of the Java programming language are not implemented (or, where noted, are only
          partially implemented):
        </p>

        <ul>
          <li>
            Java 1.4 language features:
            <ul>
              <li>
                <code>assert</code>: Partially implemented - assertions are always enabled, as if the JVM was started
                with the "<code>-ea</code>" command line option
              </li>
            </ul>
          </li>

          <li>
            Java 5 language features:
            <ul>
              <li>
                Type arguments: Are parsed, but otherwise ignored. The most significant restriction that follows is
                that you must cast return values from method invocations, e.g. "<code>(String) myMap.get(key)</code>"
              </li>
            </ul>
          </li>

          <li>
            Java 7 language features:
            <ul>
              <li>
                <code>catch</code>ing and rethrowing multiple exception types: Partially implemented; parsed and
                unparsed, but not compilable
              </li>
              <li>
                Type inference for generic instance creation (e.g. "<code>Map&lt;String, Integer&gt; map = new
                HashMap&lt;&gt;();</code>")
              </li>
            </ul>
          </li>

          <li>
            Java 8 language features:
            <ul>
              <li>Lambda expressions: Partially implemented; parsed and unparsed, but not compilable</li>
              <li>Method references: Partially implemented; parsed and unparsed, but not compilable</li>
              <li>Repeating annotations</li>
              <li>Type annotations</li>
            </ul>
          </li>

          <li>
            Java 9 language features:
            <ul>
              <li>Diamond operator with inner classes</li>
              <li>
                Modules: Partially implemented; modular compilation units are parsed and unparsed, but not compilable
              </li>
            </ul>
          </li>

          <li>
            Java 10 language features:
            <ul>
              <li>Local variable type inference: Partially implemented; parsed and unparsed, but not compilable</li>
            </ul>
          </li>

          <li>
            Java 11 language features:
            <ul>
              <li>Lambda parameter type inference: Partially implemented; parsed and unparsed, but not compilable</li>
            </ul>
          </li>
        </ul>

        <h2>
          <a id="license" class="anchor" href="#license" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>License
        </h2>
        
        <p>
          JANINO is available under the <a
          href="https://spdx.org/licenses/BSD-3-Clause.html">New BSD License</a>.
        </p>

        <h2>
          <a id="download" class="anchor" href="#download" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Download
        </h2>

        <h3>
          <a id="packages" class="anchor" href="#packages" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Packages
        </h3>

        <p>If you are using MAVEN, add this entry to your POM file:</p>

        <div class="highlight highlight-text-xml"><pre class="brush: xml">
&lt;dependency&gt;
    &lt;groupId&gt;org.codehaus.janino&lt;/groupId&gt;
    &lt;artifactId&gt;janino&lt;/artifactId&gt;
    &lt;version&gt;***&lt;/version&gt;
&lt;/dependency&gt;</pre></div>

        <div style="background-color:#000" class="syntaxHighlighter xml lineNumbers">
<!--
<dependency>
    <groupId>org.codehaus.janino</groupId> <!&#45;- BLA -&#45;>
    <artifactId>janino</artifactId>
    <version>***</version>
</dependency>
-->
          <div><code class="plain">&lt;</code><code class="keyword">dependency</code><code class="plain">&gt;</code></div>
          <div><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">&lt;</code><code class="keyword">groupId</code><code class="plain">&gt;org.codehaus.janino&lt;/</code><code class="xml keyword">groupId</code><code class="plain">&gt;</code></div>
          <div><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">&lt;</code><code class="keyword">artifactId</code><code class="plain">&gt;janino&lt;/</code><code class="keyword">artifactId</code><code class="plain">&gt;</code></div>
          <div><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">&lt;</code><code class="keyword">version</code><code class="plain">&gt;&lt;</code><code class="keyword">var</code><code class="plain">&gt;***&lt;/</code><code class="keyword">var</code><code class="plain">&gt;&lt;/</code><code class="keyword">version</code><code class="plain">&gt;</code></div>
          <div><code class="plain">&lt;/</code><code class="keyword">dependency</code><code class="plain">&gt;</code></div>
        </div>
        
<div class="highlight highlight-text-xml">
  <div>
    <div id="highlighter_424568" class="syntaxhighlighter  xml">
<!-- 
      <div class="toolbar">
        <span><a href="#" class="toolbar_item command_help help">?</a></span>
      </div>
 -->
      <table border="0" cellpadding="0" cellspacing="0">
        <tbody>
          <tr>
<!-- 
            <td class="gutter">
              <div class="line number1 index0 alt2">1</div>
              <div class="line number2 index1 alt1">2</div>
              <div class="line number3 index2 alt2">3</div>
              <div class="line number4 index3 alt1">4</div>
              <div class="line number5 index4 alt2">5</div>
            </td>
 -->
            <td class="code">
              <div class="container">
                <div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div>
                <div class="line number2 index1 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;org.codehaus.janino&lt;/</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;</code></div>
                <div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;janino&lt;/</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;</code></div>
                <div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">version</code><code class="xml plain">&gt;&lt;</code><code class="xml keyword">var</code><code class="xml plain">&gt;***&lt;/</code><code class="xml keyword">var</code><code class="xml plain">&gt;&lt;/</code><code class="xml keyword">version</code><code class="xml plain">&gt;</code></div>
                <div class="line number5 index4 alt2"><code class="xml plain">&lt;/</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

        <p>(Replace "***" with the latest version of JANINO.)</p>

        <p>If you are not using MAVEN, do the following instead:</p>

        <ul>
          <li>
            Download <a href="https://repo1.maven.org/maven2/org/codehaus/janino/janino/">the latest version of
            "janino-<var>version</var>.jar"</a>.
          </li>
          <li>
            Download <a href="https://repo1.maven.org/maven2/org/codehaus/janino/commons-compiler/">the same version of
            "commons-compiler-<var>version</var>.jar"</a>.
          </li>
          <li>Put the two JAR files on your classpath.</li>
        </ul>

        <h3>
          <a id="security_integrity" class="anchor" href="#security_integrity" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Security / integrity
        </h3>

        <p>
          All packages are signed with one of these PGP keys. Make sure to check the package signatures to prevent
          supply chain attacks:
          <br>
          <a href="pgp_key1.txt">Key #1</a>
          <a href="pgp_key2.txt">Key #2</a>
          <a href="pgp_key3.txt">Key #3</a>
        </p>

        <h3>
          <a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Installation
        </h3>

        <p>
          If you're using an IDE like ECLIPSE, you can optionally download "janino-<var>version</var>-sources.jar" and
          "commons-compiler-<var>version</var>-sources.jar" and configure them as the source attachments. That'll
          get you tooltip JAVADOC and source level debugging into the JANINO libraries.
        </p>

        <p>Use one of the features, e.g. the "expression evaluator", in your program:</p>

        <div class="highlight highlight-text-xml"><pre class="brush: java">
import org.codehaus.janino.*;

ExpressionEvaluator ee = new ExpressionEvaluator();
ee.cook("3 + 4");
System.out.println(ee.evaluate()); // Prints "7".</pre></div>

        <p>Compile, run, ... be happy!</p>

        <h3>
          <a id="examples" class="anchor" href="#examples" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Examples
        </h3>

        <p>
          The <a
          href="https://github.com/janino-compiler/janino/blob/master/commons-compiler/src/main/java/org/codehaus/commons/compiler/samples/ShippingCost.java">ShippingCost</a>
          class demonstrates how easy it is to use Janino as an expression evaluator.
        </p>

        <p>
          The <a
          href="https://github.com/janino-compiler/janino/blob/master/commons-compiler/src/main/java/org/codehaus/commons/compiler/samples/ExpressionDemo.java">ExpressionDemo</a>
          class implements a command line-based test environment for the expression evaluator.
        </p>

        <p>
          The <a
          href="https://github.com/janino-compiler/janino/blob/master/commons-compiler/src/main/java/org/codehaus/commons/compiler/samples/ScriptDemo.java">ScriptDemo</a>
          class implements a command line-based test environment for the script evaluator.
        </p>

        <p>
          The <a
          href="https://github.com/janino-compiler/janino/blob/master/commons-compiler/src/main/java/org/codehaus/commons/compiler/samples/ClassBodyDemo.java">ClassBodyDemo</a>
          class implements a command line-based test environment for the class body evaluator.
        </p>

        <p>
          The <a
          href="https://github.com/janino-compiler/janino/blob/master/janino/src/main/java/org/codehaus/janino/samples/DeclarationCounter.java">DeclarationCounter</a>
          class implements a command-line utility that counts class, interface, field and local variable declarations
          in a set of Java source files.
        </p>

        <h2>
          <a id="documentation" class="anchor" href="#documentation" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Documentation
        </h2>

        <h3>
          <a id="change_log" class="anchor" href="#change_log" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Change Log
        </h3>

        <p>
          The complete version change log is available <a href="changelog.html">here</a>.
        </p>

        <h3>
          <a id="javadoc" class="anchor" href="#javadoc" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>JAVADOC
        </h3>

        <p>
          The full JAVADOC documentation for JANINO is available <a href="apidocs/">online</a> for the latest version,
          and for <a href="https://repo1.maven.org/maven2/org/codehaus/janino/">download</a> for all versions.
        </p>

        <h3>
          <a id="books" class="anchor" href="#books" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Books
        </h3>

        <p>The specifications of the Java programming language:</p>

        <ul>
          <li>
            James Gosling, Bill Joy, Guy Steele, Gilad Bracha, Alex Buckley: <a
            href="https://docs.oracle.com/javase/specs/jls/se8/html/index.html">The Java Language Specification, Java
            SE 8 Edition</a>; Oracle America, Inc., 2013
          </li>
          <li>
            Tim Lindholm, Frank Yellin, Gilad Bracha, Alex Buckley: <a
            href="https://docs.oracle.com/javase/specs/jvms/se8/html/">The Java Virtual Machine Specification, Java SE
            8 Edition</a>; Oracle America, Inc., 2013
          </li>
        </ul>

        <p>Books that refer to the JANINO technology:</p>

        <ul>
          <li>
            Friedrich Esser: <a
            href="https://books.google.de/books?id=I1_oBQAAQBAJ&lpg=PR3&dq=Friedrich%20Esser%3A%20Java%20Core%20Techniken&pg=PA408#v=onepage&q=janino&f=false">Java
            6 Core Techniken: Essentielle Techniken fÃƒÂ¼r Java-Apps</a>; Oldenbourg, 2008
          </li>
          <li>
            Lars Wunderlich: Java Rules Engines. Entwicklung von regelbasierten Systemen; Entwickler.Press, 2006
          </li>
          <li>
            Lars Wunderlich: AOP-Aspektorientierte Programmierung in der Praxis. Konzepte und ihre Realisierung in Java;
            Entwickler.Press, 2005
          </li>
          <li>
            MarÃƒÂ­a Carina RoldÃƒÂ¡n: <a
            href="https://books.google.de/books?id=IZqtAQAAQBAJ&pg=PT351&dq=janino&hl=en&sa=X&redir_esc=y#v=onepage&q=janino&f=false">Pentaho
            Data Integration Beginner's Guide: Second Edition</a>; Packt Publishing Ltd, 2013
          </li>
          <li>
            Michael Covert, Victoria Loewengart: <a
            href="https://books.google.de/books?id=YKC9CQAAQBAJ&pg=PA74&dq=janino&hl=en&sa=X&redir_esc=y#v=onepage&q=janino&f=false">Learning
            Cascading</a>; Packt Publishing Ltd, 2015
          </li>
          <li>
            Jongsoo Park: <a
            href="https://books.google.de/books?id=FAkTUgPJbsgC&pg=PA151&dq=janino&hl=en&sa=X&redir_esc=y#v=onepage&q=janino&f=false">Memory
            Optimizations of Embedded Applications for Energy Efficiency</a>; Stanford University, 2011
          </li>
        </ul>

        <h3>
          <a id="links" class="anchor" href="#links" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Links
        </h3>

        <h4>
          <a id="articles-about-janino" class="anchor" href="#articles-about-janino" aria-hidden="true"><span
          aria-hidden="true" class="octicon octicon-link"></span></a>Articles about JANINO
        </h4>

        <ul>
          <li>
            <a href="https://www.programmersought.com/article/79415492358/">Introduction of Janino</a> on
            ProgrammerSought.
          </li>
          <li>
            Andrew Davison's Chapter <a href="http://fivedots.coe.psu.ac.th/%7Ead/jg/javaArt1/">"JavaArt. On-the-Fly
            Dynamic Compilation and Execution"</a> from his book "Killer Game Programming in Java".
          </li>
          <li>
            Tom Gibara's excellent article on his <a
            href="http://www.tomgibara.com/janino-evaluation/string-concatenation-benchmark">"String Concatenation
            Benchmark"</a>."
          </li>
        </ul>

        <h4>
          <a id="some-open-source-projects-that-use-janino" class="anchor"
          href="#some-open-source-projects-that-use-janino" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Some open source projects that use JANINO
        </h4>

        <ul>
          <li>
            <a href="https://calcite.apache.org/">Apache Calcite</a> - An open source framework for building databases
            and data management systems
          </li>
          <li>
            <a href="https://flink.apache.org/">Apache Flink</a> - Stateful Computations over Data Streams
          </li>
          <li>
            <a href="https://spark.apache.org/">Apache Spark</a> - An engine for large-scale data processing
          </li>
          <li>
            <a href="https://systemds.apache.org/">Apache SystemDS</a> - An open source ML system for the end-to-end data
            science lifecycle
          </li>
          <li>
            <a href="http://www.cascading.org/">Cascading</a> - An application development platform for building data
            applications on Apache Hadoop
          </li>
          <li>
            <a href="http://logback.qos.ch/">Logback</a> - a Java logging framework intended as a successor to the
            LOG4J project
          </li>
          <li>
            <a href="https://projects.eclipse.org/projects/rt.virgo">Virgo</a> Ã¢â‚¬â€œ the Java application server from <a
            href="http://www.eclipse.org/rt/">Eclipse RT</a>
          </li>
          <li><a href="http://wso2.com/products/carbon/">Carbon</a> Ã¢â‚¬â€œ the OSGi middleware platform of WSO2</li>
          <li>
            <a href="http://groovy-lang.org/">Groovy</a> Ã¢â‚¬â€œ an agile dynamic language for the JVM combining lots of
            great features from languages like Python, Ruby and Smalltalk and making them available to the Java
            developers using a Java-like syntax.
          </li>
          <li>
            <a href="http://www.jboss.org/products/brms/overview/">Red Hat JBoss BRMS</a> Ã¢â‚¬â€œ JBoss's business rules
            management system
          </li>
          <li>
            The <a href="http://jaitools.org/">JAITools</a> ("Java Advanced Imaging") library includes <a
            href="http://jaitools.org/docs/jiffle/latest/userguide/html/">JIFFLE</a>, an image scripting language, that
            is compiled with JANINO.
          </li>
          <li><a href="http://jinx00.sourceforge.net/">JINX</a> Ã¢â‚¬â€œ Java multi-user unix-like system.</li>
          <li>
            <a href="http://farrago.sourceforge.net/">Farrago</a> Ã¢â‚¬â€œ an extensible RDBMS framework with a hybrid
            Java/C++/UML architecture.
          </li>
          <li>
            <a href="http://jvaptools.sourceforge.net/scripteffect.html">Scripteffect</a> Ã¢â‚¬â€œ a Java VST audio plugin
            that enables audio developers or musicans to run Java code directly in their favorite audio VST host.
          </li>
          <li><a href="http://deimosproject.sourceforge.net/">Deimos</a> Ã¢â‚¬â€œ a Java-based 3D space combat game.</li>
        </ul>

        <h4>
          <a id="other-java-compiler-projects-and-products-that-i-know-about" class="anchor"
          href="#other-java-compiler-projects-and-products-that-i-know-about" aria-hidden="true"><span
          aria-hidden="true" class="octicon octicon-link"></span></a>Other Java compiler projects and products that I
          know about
        </h4>

        <ul>
           <li><a href="http://www.embarcadero.com/products/jbuilder">Embarcadero JBuilder</a></li>
           <li><a href="https://gcc.gnu.org/java/">gcj</a> Ã¢â‚¬â€œ the GNU Compiler for Java</li>
           <li>
             <a href="http://docs.oracle.com/javase/8/docs/technotes/tools/windows/javac.html">javac</a> Ã¢â‚¬â€œ the Java
             compiler from ORACLE
           </li>
           <li><a href="http://jikes.sourceforge.net/">jikes Ã¢â‚¬â€œ IBM's Java compiler</a></li>
           <li>
             <a href="http://cs.gmu.edu/%7Eeclab/projects/robots/flockbots/uploads/Main/kopi.html">The Kopi Java
             Compiler</a>
           </li>
           <li><a href="http://pizzacompiler.sourceforge.net/">Pizza</a></li>
           <li><a href="http://types.bu.edu/Espresso/JavaEspresso.html">Espresso</a></li>
        </ul>

        <h3>
          <a id="basic-examples" class="anchor" href="#basic-examples" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Basic Examples
        </h3>

        <h4>
          <a id="janino-as-an-expression-evaluator" class="anchor" href="#janino-as-an-expression-evaluator"
          aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Janino as an Expression
          Evaluator
        </h4>

        <p>
          Say you build an e-commerce system, which computes the shipping cost for the items that the user put into
          his/her shopping cart. Because you don't know the merchant's shipping cost model at implementation time, you
          could implement a set of shipping cost models that come to mind (flat charge, by weight, by number of items,
          ...) and select one of those at run-time.
        </p>

        <p>
          In practice, you will most certainly find that the shipping cost models you implemented will rarely match
          what the merchant wants, so you must add custom models, which are merchant-specific. If the merchant's model
          changes later, you must change your code, re-compile and re-distribute your software.
        </p>

        <p>
          Because this is so unflexible, the shipping cost expression should be specified at run-time, not at
          compile-time. This implies that the expression must be scanned, parsed and evaluated at run-time, which is
          why you need an expression evaluator.
        </p>

        <p>
          A simple expression evaluator would parse an expression and create a "syntax tree". The expression
          "a + b * c", for example, would compile into a "Sum" object who's first operand is parameter "a" and who's
          second operand is a "Product" object who's operands are parameters "b" and "c". Such a syntax tree can
          evaluated relatively quickly. However, the run-time performance is about a factor of 100 worse than that of
          "native" Java code executed directly by the JVM. This limits the use of such an expression evaluator to
          simple applications.
        </p>

        <p>
          Also, you may want not only do simple arithmetics like "a + b * c % d", but take the concept further and have
          a real "scripting" language which adds flexibility to your application. Since you know the Java programming
          language already, you may want to have a syntax that is similar to that of the Java programming language.
        </p>

        <p>
          All these considerations lead to compilation of Java code at run-time, like some engines (e.g. JSP engines)
          already do. However, compiling Java programs with ORACLE's JDK is a relatively resource-intensive process
          (disk access, CPU time, ...). This is where Janino comes into play... a light-weight, "embedded" Java
          compiler that compiles simple programs in memory into JVM bytecode which executes within the JVM of the
          running program.
        </p>

        <p>OK, now you are curious... this is how you use the ExpressionEvaluator:</p>

        <div class="highlight highlight-text-xml"><pre class="brush: java">
package foo;

import java.lang.reflect.InvocationTargetException;

import org.codehaus.commons.compiler.CompileException;
import org.codehaus.janino.ExpressionEvaluator;

public class Main {

    public static void
    main(String[] args) throws CompileException, InvocationTargetException {

        // Now here's where the story begins...
        ExpressionEvaluator ee = new ExpressionEvaluator();

        // The expression will have two "int" parameters: "a" and "b".
        ee.setParameters(new String[] { "a", "b" }, new Class[] { int.class, int.class });

        // And the expression (i.e. "result") type is also "int".
        ee.setExpressionType(int.class);

        // And now we "cook" (scan, parse, compile and load) the fabulous expression.
        ee.cook("a + b");

        // Eventually we evaluate the expression - and that goes super-fast.
        int result = (Integer) ee.evaluate(new Object[] { 19, 23 });
        System.out.println(result);
    }
}</pre></div>

        <p>
          Notice: If you pass a string literal as the expression, be sure to escape all Java special characters,
          especially backslashes.
        </p>

        <p>
          The compilation of the expression takes 670 microseconds on my machine (2 GHz P4), and the evaluation 0.35
          microseconds (approx. 2000 times faster than compilation).
        </p>

        <p>
          There is a sample program "ExpressionDemo" that you can use to play around with the ExpressionEvaluator, or
          you can study <a href="http://janino.unkrig.de/samples/ExpressionDemo.java">ExpressionDemo's source code</a>
          to learn about ExpressionEvaluator's API:
        </p>

        <div class="highlight highlight-text-xml"><pre class="brush: bash">
$ java -cp janino.jar:commons-compiler.jar \
&gt; org.codehaus.commons.compiler.samples.ExpressionDemo \
&gt; -help
Usage:
  ExpressionDemo { &lt;option&gt; } &lt;expression&gt; { &lt;parameter-value&gt; }
Compiles and evaluates the given expression and prints its value.
Valid options are
 -et &lt;expression-type&gt;                        (default: any)
 -pn &lt;comma-separated-parameter-names&gt;        (default: none)
 -pt &lt;comma-separated-parameter-types&gt;        (default: none)
 -te &lt;comma-separated-thrown-exception-types&gt; (default: none)
 -di &lt;comma-separated-default-imports&gt;        (default: none)
 -help
The number of parameter names, types and values must be identical.
$ java -cp janino.jar:commons-compiler.jar \
&gt; org.codehaus.commons.compiler.samples.ExpressionDemo \
&gt; -et double \
&gt; -pn x \
&gt; -pt double \
&gt; "Math.sqrt(x)" \
&gt; 99
Result = 9.9498743710662
$</pre></div>

        <h4>
          <a id="janino-as-a-script-evaluator" class="anchor" href="#janino-as-a-script-evaluator"
          aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Janino as a Script
          Evaluator
        </h4>

        <p>
          Analogously to the expression evaluator, a ScriptEvaluator API exists that compiles and processes a Java
          "block", i.e. the body of a method. If a return value other than "void" is defined, then the block must
          return a value of that type.
        </p>

        <p>
          As a special feature, it allows methods to be declared. The place and order of the method declarations is not
          relevant.
        </p>

        <p>Example:</p>

        <div class="highlight highlight-text-xml"><pre class="brush: java">
package foo;

import java.lang.reflect.InvocationTargetException;

import org.codehaus.commons.compiler.CompileException;
import org.codehaus.janino.ScriptEvaluator;

public class Main {

    public static void
    main(String[] args) throws CompileException, NumberFormatException, InvocationTargetException {

        ScriptEvaluator se = new ScriptEvaluator();

        se.cook(
            ""
            + "static void method1() {\n"
            + "    System.out.println(1);\n"
            + "}\n"
            + "\n"
            + "method1();\n"
            + "method2();\n"
            + "\n"
            + "static void method2() {\n"
            + "    System.out.println(2);\n"
            + "}\n"
        );

        se.evaluate();
    }
}</pre></div>

        <p>
          As for the expression compiler, there is a demo program "ScriptDemo" for you to play with the ScriptEvaluator
          API:
        </p>

        <div class="highlight highlight-text-xml"><pre class="brush: bash">
$ java -cp janino.jar:commons-compiler.jar \
&gt; org.codehaus.commons.compiler.samples.ScriptDemo -help
Usage:
  ScriptDemo { &lt;option&gt; } &lt;script&gt; { &lt;parameter-value&gt; }
Valid options are
 -rt &lt;return-type&gt;                            (default: void)
 -pn &lt;comma-separated-parameter-names&gt;        (default: none)
 -pt &lt;comma-separated-parameter-types&gt;        (default: none)
 -te &lt;comma-separated-thrown-exception-types&gt; (default: none)
 -di &lt;comma-separated-default-imports&gt;        (default: none)
 -help
The number of parameter names, types and values must be identical.
$ java -cp janino.jar:commons-compiler.jar \
&gt; org.codehaus.commons.compiler.samples.ScriptDemo '
&gt; for (int i = 0; i &lt; 3; i++) {
&gt;     System.out.println("HELLO");
&gt; }'
HELLO
HELLO
HELLO
Result = (null)
$</pre></div>

        <p>
          Check <a href="http://janino.unkrig.de/samples/ScriptDemo.java">the source code of ScriptDemo</a> to learn
          more about the ScriptEvaluator API.
        </p>

        <h4>
          <a id="janino-as-a-class-body-evaluator" class="anchor" href="#janino-as-a-class-body-evaluator"
          aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Janino as a Class Body
          Evaluator
        </h4>

        <p>
          Analogously to the expression evaluator and the script evaluator, a ClassBodyEvaluator exists that compiles
          and processes the body of a Java class, i.e. a series of method and variable declarations. If you define a
          contract that the class body should define a method named "main()", then your script will look almost like a
          "C" program:
        </p>

        <div class="highlight highlight-text-xml"><pre class="brush: java">
public static void
main(String[] args) {
    System.out.println(java.util.Arrays.asList(args));
}</pre></div>

        <p>The "ClassBodyDemo" program (source code) demonstrates this:</p>

        <div class="highlight highlight-text-xml"><pre class="brush: bash">
$ java -cp janino.jar:commons-compiler.jar \
&gt; org.codehaus.commons.compiler.samples.ClassBodyDemo -help
Usage:
  ClassBodyDemo &lt;class-body&gt; { &lt;argument&gt; }
  ClassBodyDemo -help
If &lt;class-body&gt; starts with a '@', then the class body is read
from the named file.
The &lt;class-body&gt; must declare a method "public static void main(String[])"
to which the &lt;argument&gt;s are passed. If the return type of that method is
not VOID, then the returned value is printed to STDOUT.
$ java -cp janino.jar:commons-compiler.jar \
&gt; org.codehaus.commons.compiler.samples.ClassBodyDemo '
&gt; public static void
&gt; main(String[] args) {
&gt;     System.out.println(java.util.Arrays.asList(args));
&gt; }' \
&gt; a b c
[a, b, c]
$</pre></div>

        <h4>
          <a id="janino-as-a-simple-compiler" class="anchor" href="#janino-as-a-simple-compiler"
          aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Janino as a Simple
          Compiler
        </h4>

        <p>
          The <code>SimpleCompiler</code> compiles a single .java file ("compilation unit").
          Opposed to normal Java compilation, that compilation unit may declare <em>more than one</em> public type.
        </p>
        
        <p>Example:</p>

        <div class="highlight highlight-text-xml"><pre class="brush: java">
// This is file "Hello.java", but it could have any name.

public
class Foo {

    public static void
    main(String[] args) {
        new Bar().meth();
    }
}

public
class Bar {

    public void
    meth() {
        System.out.println("HELLO!");
    }
}</pre></div>

        <p>It returns a <code>ClassLoader</code> from which you can retrieve the classes that were compiled.</p>

        <p>To run this, type:</p>

        <div class="highlight highlight-text-xml"><pre class="brush: bash">
$ java -cp janino.jar:commons-compiler.jar \
&gt; org.codehaus.janino.SimpleCompiler -help
Usage:
    org.codehaus.janino.SimpleCompiler &lt;source-file&gt; &lt;class-name&gt; { &lt;argument&gt; }
Reads a compilation unit from the given &lt;source-file&gt; and invokes method
"public static void main(String[])" of class &lt;class-name&gt;, passing the
given &lt;argument&gt;s.
$ java -cp janino.jar:commons-compiler.jar \
&gt; org.codehaus.janino.SimpleCompiler \
&gt; Hello.java Foo
HELLO!
$</pre></div>


        <h4>
          <a id="janino-as-a compiler" class="anchor" href="#janino-as-a compiler"
          aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Janino as a Compiler
        </h4>

        <p>
          The <code>Compiler</code> compiles a set of .java files ("compilation units"), and creates .class files.
          Each compilation unit may declare a different package, and the compilation units may reference each other,
          even in a circular manner.
        </p>
        
        <p>Example:</p>

        <div class="highlight highlight-text-xml"><pre class="brush: java">

ICompiler compiler = compilerFactory.newCompiler();

compiler.compile(new File("pkg1/A.java"), new File("pkg2/B.java"));</pre></div>

        <p>
          However the <code>Compiler</code> can be reconfigured to read the compilation units from a different source,
          and/or to store the classes in a different place, e.g. into a <code>Map</code>, which is then loaded into
          the VM through a ClassLoader:
        </p>
        <div class="highlight highlight-text-xml"><pre class="brush: java">

ICompiler compiler = compilerFactory.newCompiler();

// Store generated .class files in a Map:
Map&lt;String, byte[]> classes = new HashMap&lt;String, byte[]>();
compiler.setClassFileCreator(new MapResourceCreator(classes));

// Now compile two units from strings:
compiler.compile(new Resource[] {
    new StringResource(
        "pkg1/A.java",
        "package pkg1; public class A { public static int meth() { return pkg2.B.meth(); } }"
    ),
    new StringResource(
        "pkg2/B.java",
        "package pkg2; public class B { public static int meth() { return 77;            } }"
    ),
});

// Set up a class loader that uses the generated classes.
ClassLoader cl = new ResourceFinderClassLoader(
    new MapResourceFinder(classes),    // resourceFinder
    ClassLoader.getSystemClassLoader() // parent
);

Assert.assertEquals(77, cl.loadClass("pkg1.A").getDeclaredMethod("meth").invoke(null));</pre></div>

        <h3>
          <a id="advanced-examples" class="anchor" href="#advanced-examples" aria-hidden="true"><span
          aria-hidden="true" class="octicon octicon-link"></span></a>Advanced Examples
        </h3>

        <h4>
          <a id="janino-as-a-source-code-classloader" class="anchor" href="#janino-as-a-source-code-classloader"
          aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Janino as a Source Code
          Class Loader
        </h4>

        <p>
          The <code>JavaSourceClassLoader</code> extends Java's <code>java.lang.ClassLoader</code> class with the
          ability to load classes directly from source code.
        </p>

        <p>
          To be precise, if a class is loaded through this class loader, it searches for a matching ".java" file in any
          of the directories specified by a given "source path", reads, scans, parses and compiles it and defines the
          resulting classes in the JVM. As necessary, more classes are loaded through the parent class loader and/or
          through the source path. No intermediate files are created in the file system.
        </p>

        <p>Example:</p>

        <div class="highlight highlight-text-xml"><pre class="brush: java">
// srcdir/pkg1/A.java

package pkg1;

import pkg2.*;

public class A extends B {
}</pre></div>

        <div class="highlight highlight-text-xml"><pre class="brush: java">
// srcdir/pkg2/B.java

package pkg2;

public class B implements Runnable {
    public void run() {
        System.out.println("HELLO");
    }
}</pre></div>

        <div class="highlight highlight-text-xml"><pre class="brush: java">
// Sample code that reads, scans, parses, compiles and loads
// "A.java" and "B.java", then instantiates an object of class
// "A" and invokes its "run()" method.
ClassLoader cl = new JavaSourceClassLoader(
    this.getClass().getClassLoader(),  // parentClassLoader
    new File[] { new File("srcdir") }, // optionalSourcePath
    (String) null,                     // optionalCharacterEncoding
    DebuggingInformation.NONE          // debuggingInformation
);

// Load class A from "srcdir/pkg1/A.java", and also its superclass
// B from "srcdir/pkg2/B.java":
Object o = cl.loadClass("pkg1.A").newInstance();

// Class "B" implements "Runnable", so we can cast "o" to
// "Runnable".
((Runnable) o).run(); // Prints "HELLO" to "System.out".</pre></div>

        <p>
          If the Java source is not available in files, but from some other storage (database, main memory, ...), you
          may specify a custom ResourceFinder instead of the directory-based source path.
        </p>

        <p>
          If you have many source files and you want to reduce the compilation time, you may want to use the
          <code>CachingJavaSourceClassLoader</code>, which uses a cache provided by the application to store class
          files for repeated use.
        </p>

        <h4>
          <a id="jsh" class="anchor" href="#jsh" aria-hidden="true"><span aria-hidden="true" class="octicon
          octicon-link"></span></a>jsh - the Java shell
        </h4>

        <p>
          JANINO has a sister project <a href="https://github.com/janino-compiler/jsh">"jsh"</a> which implements a
          "shell" program similar to "bash", "ksh", "csh" etc., but with Java syntax.
        </p>

        <h4>
          <a id="janino-as-a-command-line-java-compiler" class="anchor" href="#janino-as-a-command-line-java-compiler"
          aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Janino as a Command-Line
          Java Compiler
        </h4>

        <p>
          The <a href="http://janino.unkrig.de/javadoc/org/codehaus/janino/Compiler.html">Compiler</a> class mimics the
          behavior of ORACLE's javac tool. It compiles a set of "compilation units" (i.e. Java source files) into a
          set of class files.
        </p>

        <p>
          Using the "-warn" option, Janino emits some probably very interesting warnings which may help you to
          "clean up" the source code.
        </p>

        <p>
          The BASH script "<a
          href="https://github.com/janino-compiler/janino/blob/master/janino/bin/janinoc">bin/janinoc</a>" implements a
          drop-in replacement for ORACLE's JAVAC utility:
        </p>

        <div class="highlight highlight-text-xml"><pre class="brush: bash">
$ janinoc -sourcepath src -d classes src/com/acme/MyClass.java
$ janinoc -help
A drop-in replacement for the JAVAC compiler, see the documentation for JAVAC
Usage:

  java java.lang.Compiler [ &lt;option&gt; ] ... &lt;source-file&gt; ...

Supported &lt;option&gt;s are:
  -d &lt;output-dir&gt;           Where to save class files
  -sourcepath &lt;dirlist&gt;     Where to look for other source files
  -classpath &lt;dirlist&gt;      Where to look for other class files
  -extdirs &lt;dirlist&gt;        Where to look for other class files
  -bootclasspath &lt;dirlist&gt;  Where to look for other class files
  -encoding &lt;encoding&gt;      Encoding of source files, e.g. "UTF-8" or "ISO-8859-1"
  -verbose
  -g                        Generate all debugging info
  -g:none                   Generate no debugging info (the default)
  -g:{source,lines,vars}    Generate only some debugging info
  -rebuild                  Compile all source files, even if the class files
                            seem up-to-date
  -help

The default encoding in this environment is "UTF-8".
$</pre></div>

        <h4>
          <a id="janino-as-an-ant-compiler" class="anchor" href="#janino-as-an-ant-compiler" aria-hidden="true"><span
          aria-hidden="true" class="octicon octicon-link"></span></a>Janino as an ANT Compiler
        </h4>

        <p>
          You can plug JANINO into the ANT utility through the <a
          href="http://janino.unkrig.de/javadoc/org/codehaus/janino/AntCompilerAdapter.html">AntCompilerAdapter</a>
          class. Just make sure that janino.jar is on the class path, then run ANT with the following command-line
          option:
        </p>

        <div class="highlight highlight-text-xml"><pre class="brush: bash">
-Dbuild.compiler=org.codehaus.janino.AntCompilerAdapter</pre></div>

        <h4>
          <a id="janino-as-a-tomcat-compiler" class="anchor" href="#janino-as-a-tomcat-compiler"
          aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Janino as a TOMCAT
          Compiler
        </h4>

        <p>
          If you want to use JANINO with TOMCAT, just copy the "janino.jar" file into TOMCAT's "common/lib" directory,
          and add the follwing init parameter section to the JSP servlet definition in TOMCAT's "conf/web.xml" file:
        </p>

        <div class="highlight highlight-text-xml"><pre class="brush: xml">
&lt;init-param&gt;
    &lt;param-name&gt;compiler&lt;/param-name&gt;
    &lt;param-value&gt;org.codehaus.janino.AntCompilerAdapter&lt;/param-value&gt;
&lt;/init-param&gt;</pre></div>

        <h4>
          <a id="janino-as-a-code-analyser" class="anchor" href="#janino-as-a-code-analyser" aria-hidden="true"><span
          aria-hidden="true" class="octicon octicon-link"></span></a>Janino as a Code Analyser
        </h4>

        <p>
          Apart from compiling Java code, JANINO can be used for static code analysis: Based on the AST
          ("abstract syntax tree") produced by the parser, the <a
          href="http://janino.unkrig.de/javadoc/org/codehaus/janino/util/Traverser.html">Traverser</a> walks through
          all nodes of the AST, and derived classes can do all kinds of analyses on them, e.g. count declarations:
        </p>

        <div class="highlight highlight-text-xml"><pre class="brush: bash">
$ java org.codehaus.janino.samples.DeclarationCounter DeclarationCounter.java
Class declarations:     1
Interface declarations: 0
Fields:                 4
Local variables:        4
$</pre></div>

        <p>This is the basis for all these neat code metrics and style checking.</p>

        <h4>
          <a id="janino-as-a-code-manipulator" class="anchor" href="#janino-as-a-code-manipulator"
          aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Janino as a Code
          Manipulator
        </h4>

        <p>
          If you want to read a Java compilation unit into memory, manipulate it, and then write it back to a file for
          compilation, then all you have to do is:
        </p>

        <div class="highlight highlight-text-xml"><pre class="brush: java">
// Read the compilation unit from Reader "r" into memory.
Java.CompilationUnit cu = new Parser(new Scanner(fileName, r)).parseCompilationUnit();

// Manipulate the AST in memory.
// ...

// Convert the AST back into text.
UnparseVisitor.unparse(cu, new OutputStreamWriter(System.out));</pre></div>

        <p>
          The <a
          href="https://github.com/janino-compiler/janino/blob/master/janino/src/test/java/org/codehaus/janino/tests/AstTest.java#LC359"><code>AstTest.testMoveLocalVariablesToFields()</code></a>
          test case demostrates how to manipulate an AST.
        </p>

        <h4>
          <a id="alternative-compiler-implementations" class="anchor" href="#alternative-compiler-implementations"
          aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Alternative Compiler
          Implementations
        </h4>

        <p>
          JANINO can be configured to use not its own Java compiler, but an alternative implementation. Alternative
          implementations must basically implement the interface <code>ICompilerFactory</code>.
          One such alternative implementation is based on the <code>javax.tools</code> API, and is shipped as part
          of the JANINO distribution: commons-compiler-jdk.jar.
        </p>

        <p>Basically there are two ways to switch implementations:</p>

        <ul>
          <li>
            Use <code>org.codehaus.commons.compiler.jdk.ExpressionEvaluator</code> and consorts instead of
            <code>org.codehaus.janino.ExpressionEvaluator</code>; put commons-compiler-jdk.jar instead of janino.jar on
            your compile-time and runtime classpath. (commons-compiler.jar must always be on the classpath, because it
            contains the basic classes that all implementations require.)
          </li>
          <li>
            Use
            <code>org.codehaus.commons.compiler.CompilerFactoryFactory.getDefaultFactory().newExpressionEvaluator()</code>
            and compile only against commons-compiler.jar (and no concrete implementation). At runtime, add one
            implementation (janino.jar or commons-compiler-jdk.jar) to the class path, and getDefaultFactory() will
            find it at runtime.
          </li>
        </ul>

        <p>
          The performance of the code <em>generated</em> by the JDK-based implementation is the same as with the JANINO
          implementation; the <em>compilation</em>, however, is slower by a factor of 22 (measured by compiling the expression
          <code>"a + b"</code>; two <code>int</code>s, see below).
          The main reason is that the <code>javax.tools</code> compiler loads the required JRE classes through the classpath,
          when JANINO uses classes that are already loaded into the running JVM. Thus, <code>CompilerDemo</code> (the drop-in
          replacement for JAVAC) is not faster than JAVAC (measured by compiling the Janino source code, see below).
        </p>
        <table>
        	<tr><th>Activity</th><th>Janino</th><th>JDK</th></tr>
        	<tr><td>Compile expression <code>"a + b"</code></td><td>0.44 ms</td><td>9.84 ms</td></tr>
        	<tr><td>Compile Janino source code</td><td>6.417 s</td><td>5.864 s</td></tr>
        </table>
        <p>
          (Measured with JDK 17 and JRE 17.)
        </p>

        <h3>
          <a id="security" class="anchor" href="#security" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Security
        </h3>

        <p>
          <b>Warning: JRE 17 reports "System::setSecurityManager will be removed in a future release", so you should not
          use the Janino sandbox with JRE 17+.</b>
        </p>

        <p>
          Because the bytecode generated by JANINO has full access to the JRE, security problems can arise if the
          expression, script, class body or compilation unit being compiled and executed contains user input.
        </p>

        <p>
          If that user is an educated system administrator, he or she can be expected to use JANINO responsibly and in
          accordance with documentation and caveats you provide; however if the user is an intranet or internet user,
          no assumtions should be made about how clumsy, frivolous, creative, single-minded or even malicious he or she
          could be.
        </p>

        <p>
          JANINO includes a very easy-to-use security API, which can be used to lock expressions, scripts, class bodies
          and compilation units into a "sandbox", which is guarded by a Java security manager:
        </p>

        <div class="highlight highlight-text-xml"><pre class="brush: java">
import java.security.Permissions;
import java.security.PrivilegedAction;
import java.util.PropertyPermission;
import org.codehaus.janino.ScriptEvaluator;
import org.codehaus.commons.compiler.Sandbox;

public class SandboxDemo {

    public static void
    main(String[] args) throws Exception {

        // Create a JANINO script evaluator. The example, however, will work as fine with
        // ExpressionEvaluators, ClassBodyEvaluators and SimpleCompilers.
        ScriptEvaluator se = new ScriptEvaluator();
        se.setDebuggingInformation(true, true, false);

        // Now create a "Permissions" object which allows to read the system variable
        // "foo", and forbids everything else.
        Permissions permissions = new Permissions();
        permissions.add(new PropertyPermission("foo", "read"));

        // Compile a simple script which reads two system variables - "foo" and "bar".
        PrivilegedAction&lt;?> pa = se.createFastEvaluator((
            "System.getProperty(\"foo\");\n" +
            "System.getProperty(\"bar\");\n" +
            "return null;\n"
        ), PrivilegedAction.class, new String[0]);

        // Finally execute the script in the sandbox. Getting system property "foo" will
        // succeed, and getting "bar" will throw a
        //    java.security.AccessControlException: access denied (java.util.PropertyPermission bar read)
        // in line 2 of the script. Et voila!
        Sandbox sandbox = new Sandbox(permissions);
        sandbox.confine(pa);
    }
}</pre></div>

        <p>
          The official documentation of the Java security manager is <a
          href="https://docs.oracle.com/javase/tutorial/essential/environment/security.html">ORACLE: Java Essentials:
          The Security Manager</a>. Actions that are guarded by permissions include:
        </p>
        <ul>
          <li>Accept a socket connection from a specified host and port number</li>
          <li>Modify a thread (change its priority, stop it, and so on)</li>
          <li>Open a socket connection to a specified host and port number</li>
          <li>Create a new class loader</li>
          <li>Delete a specified file</li>
          <li>Create a new process</li>
          <li>Cause the application to exit</li>
          <li>Load a dynamic library that contains native methods</li>
          <li>Wait for a connection on a specified local port number</li>
          <li>Load a class from a specified package (used by class loaders)</li>
          <li>Add a new class to a specified package (used by class loaders)</li>
          <li>Access or modify system properties</li>
          <li>Access a specified system property</li>
          <li>Read from a specified file</li>
          <li>Write to a specified file</li>
        </ul>
        <p>
          These are the "really evil things" that an attacker might do. However actions that are <em>not</em> guarded
          are:
        </p>
        <ul>
          <li>Allocate memory</li>
          <li>Create new threads</li>
          <li>Use CPU time excessively</li>
        </ul>
        <p>
          Luckily, the Thread constructor does some reflection, so thread creation by scripts can be prevented by not
          allowing <code>new RuntimePermission("accessDeclaredMembers")</code>.
        </p>
        <p>
          Memory allocation can not be guarded, however,
          <code>com.sun.management.ThreadMXBean.getThreadAllocatedBytes(long threadId)</code> appears to <em>count the
          number of bytes ever allocated by a thread</em>, and may thus be a good measure to detect excessive memory
          allocation by a running script.
        </p>

        <h3>
          <a id="debugging" class="anchor" href="#debugging" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Debugging
        </h3>

        <p>The generated classes can be debugged interactively, even though they were created on-the-fly.</p>

        <p>All that needs to be done is set two system properties, e.g. when starting the JVM:</p>

        <div class="highlight highlight-text-xml"><pre class="brush: bash">
$ java \
&gt; ... \
&gt; -Dorg.codehaus.janino.source_debugging.enable=true \
&gt; -Dorg.codehaus.janino.source_debugging.dir=C:\tmp \
&gt; ...</pre></div>

        <p>
          (The second property is optional; if not set, then the temporary files will be created in the default
          temporary-file directory.)
        </p>

        <p>
          When JANINO scans an expression, script, class body or compilation unit, it stores a copy of the source code
          in a temporary file which the debugger accesses through its source path. (The temporary file will be deleted
          when the JVM terminates.)
        </p>

        <p>Then when you debug your program</p>

        <p><img src="images/janino-debugging.jpg" alt="Debugging"></p>

        <p>, you can step right into the generated code</p>

        <p><img src="images/janino-debugging2.jpg" alt="Debugging"></p>

        <p>, and debug it:</p>

        <p><img src="images/janino-debugging3.jpg" alt="Debugging"></p>

        <p>As you can see, you can even inspect and modify fields and variables - everything your debugger supports.</p>

        <h2>
          <a id="contact" class="anchor" href="#contact" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Contact
        </h2>

        <h3>
          <a id="reporting-bugs" class="anchor" href="#reporting-bugs" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Reporting bugs
        </h3>

        <p>If you think you have found a bug in Janino, proceed as follows:</p>

        <ul>
          <li>
            If you're getting an unexpected compilation error, verify that ORACLE's Java compiler JAVAC also believes
            it is one.
          </li>
          <li>
            Try to isolate the problem. Don't send me huge source files; attempt, if at all possible, to reproduce the
            problem with a JUNIT unit test, or with the ExpressionDemo/ScriptDemo/ClassBodyDemo command-line tools.
          </li>
          <li>
            Sign up at GITHUB and create an issue <a href="https://github.com/janino-compiler/janino/issues">there</a>.
            Please state which version of Janino you were using, what you did, what you expected to happen and what
            actually happened.
          </li>
        </ul>

        <h3>
          <a id="requesting-support" class="anchor" href="#requesting-support" aria-hidden="true"><span
          aria-hidden="true" class="octicon octicon-link"></span></a>Requesting support
        </h3>

        <p>
          If you require support, <a href="https://github.com/janino-compiler/janino/issues">this</a> is the place
          to ask for it.
        </p>

        <h3>
          <a id="requesting-new-features" class="anchor" href="#requesting-new-features" aria-hidden="true"><span
          aria-hidden="true" class="octicon octicon-link"></span></a>Requesting new features
        </h3>

        <p>
          Feel free to submit feature requests <a href="https://github.com/janino-compiler/janino/issues">here</a>.
        </p>

        <h3>
          <a id="feedback" class="anchor" href="#feedback" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Feedback
        </h3>

        <p>
          I appreciate your feedback. Let me know how you want to utilize Janino, if you find it useful, or why you
          cannot use it for your project.
        </p>

        <h2>
          <a id="developers" class="anchor" href="#developers" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Developers
        </h2>

        <h3>
          <a id="source-code-repository" class="anchor" href="#source-code-repository" aria-hidden="true"><span
          aria-hidden="true" class="octicon octicon-link"></span></a>Source Code Repository
        </h3>

        <p>
          The JANINO code repository is <a href="https://github.com/janino-compiler/janino">here</a>. You have to check
          out at least the following projects:
        </p>

        <ul>
          <li><a href="https://github.com/janino-compiler/janino/tree/master/janino-parent">janino-parent</a></li>
          <li>
            <a href="https://github.com/janino-compiler/janino/tree/master/commons-compiler">commons-compiler</a>
          </li>
          <li><a href="https://github.com/janino-compiler/janino/tree/master/janino">janino</a></li>
        </ul>

        <p>Optional:</p>

        <ul>
          <li>
            <a
            href="https://github.com/janino-compiler/janino/tree/master/commons-compiler-jdk">commons-compiler-jdk</a>
          </li>
          <li>
            <a
            href="https://github.com/janino-compiler/janino/tree/master/commons-compiler-tests">commons-compiler-tests</a>
          </li>
          <li>
            <a href="https://github.com/aunkrig/jdisasm/tree/master/jdisasm">jdisasm</a>
          </li>
        </ul>

        <p>
          Then you can build the JAR files, the source archives and the JAVADOC archives by running <code>mvn
          install</code> in the <code>janino-parent</code> project.
        </p>

        <h3>
          <a id="contributing" class="anchor" href="#contributing" aria-hidden="true"><span aria-hidden="true"
          class="octicon octicon-link"></span></a>Contributing
        </h3>

        <p>
          If you want to contribute, turn to me: arno att unkrig dott de. Any support is welcome, be it bug reports,
          feature requests, documentation reviews or other work. Help building a better world with JANINO!
        </p>
      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="https://github.com/janino-compiler">janino-compiler</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>SyntaxHighlighter.all()</script>
  </body>
</html>
